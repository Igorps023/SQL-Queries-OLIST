/*  GROUP BY STATE AND CITY
    NUM_OF_OCCURRENCES AS ROWS, UNIQUE_IDS PER CITY
    SORTED BY MOST POPULOUS CITIES DESCENDING
*/

SELECT 
 
customer_state,

COUNT(*) AS NUM_ROWS,
COUNT (DISTINCT customer_unique_id ) AS UNIQUE_ID,
COUNT (DISTINCT customer_city) AS NUM_CITY

FROM tb_customers

GROUP BY customer_state
ORDER BY UNIQUE_ID DESC